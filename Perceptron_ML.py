import pandas as pd
import numpy as np
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import SGD


df = pd.read_csv('result.csv', header=None)

X = df.iloc[:,:-3]
Y = df.iloc[:,-3:]

model = Sequential()
model.add(Dense(units =3, input_dim=X.shape[1], activation='sigmoid'))

model.compile(loss = 'binary_crossentropy', optimizer=SGD(learning_rate=0.1), metrics=['accuracy'])

model.fit(X, Y, epochs=500, batch_size=32, verbose=1)

predictions = model.predict(X)

model.save("perceptron_1.keras")

print(predictions)
test_ligne = np.array([[0.0, 1.0, 0.6824947261759632, -0.7308905176166928, 0.5191847526700926, -0.8546620341368246, 0.38669402224406535, -0.9222080747644245, 0.17675389097888033, -0.9842550797551548, -0.48364906046869294, -0.8752620100905503, -0.8231107145925721, -0.5678809307618151, -0.953757225433526, -0.3005780346820809, 0.9451327428557584, 0.3266865445376511, 0.9678002312679959, -0.25171951127716274, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, -0.7914799670996647, 0.6111951093390013, 0.5524073753596158, 0.8335742868204973, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, -0.09889073319630641, 0.995098298103206, 0.3853893415961603, 0.9227540600745564, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.008713102523969484, 0.9999620402017303, -0.5928829412570392, 0.8052886550587947, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.15634811614397223, 0.9877020130475744, -0.8594274286657478, 0.5112577577474801, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.9508706683559061, -0.3095883913527645, 0.9785835617330878, 0.20584997621030696, 0.842629140002317, 0.5384943197648007, -0.3904150533801538, -0.9206389553425228, -0.9921631727200613, -0.124948944365536, 0.03592773798994906, 0.999354390415595, -0.999932229493505, 0.01164201100104375, 0.9984446033271428, 0.055752794431349624, 0.7963252511215688, -0.604868658822864, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, -0.5570875424480685, -0.8304537735775372, -0.6543560055405955, -0.756186629088981, -0.8872092809378599, -0.46136719846313895]], dtype=np.float32)

pred_test = model.predict(test_ligne)

print("############  TEST  ############")
print(pred_test)
